<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <title>Anigrams</title>
  <meta name="generator" content="Jekyll v3.9.2" />
  <meta property="og:title" content="ğŸ¦‰ğŸ¦’ğŸ¬ Anigrams ğŸ¦œğŸ™ğŸ" />
  <meta property="og:locale" content="en_US" />
  <meta name="description" content="A daily word game" />
  <meta property="og:description" content="A daily word game" />
  <link rel="canonical" href="http://anigrams.us" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ</text></svg>">
  <meta property="og:url" content="http://anigrams.us" />
  <meta property="og:site_name" content="ğŸ¦‰ğŸ¦’ğŸ¬ Anigrams ğŸ¦œğŸ™ğŸ" />
  <meta property="og:type" content="website" />
  <meta name="twitter:card" content="summary" />
  <meta property="twitter:title" content="ğŸ¦‰ğŸ¦’ğŸ¬ Anigrams ğŸ¦œğŸ™ğŸ" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,300">
  <link rel="stylesheet" href="main.css">
</head>

<body ontouchstart="">
  <header class="site-header" role="banner">
    <div class="header-wrapper">
      <a class="title" rel="author" href="/">Anigrams</a>
      <div class="flex-container">
        <button class="link-button" role="button" onClick="openModal('rulesModal')">Rules</button>
        <button class="link-button" role="button" onClick="openModal('aboutModal')">About</button>
      </div>
    </div>
  </header>
  <main class="page-content" aria-label="Content">
    <div class="wrapper">
      <article class="post">
        <div id="introInfo">
          <div>Unscramble a word to reveal the next letter</div>
          <div>Level</div>
        </div>
        <div id="timer-acpt"></div>
        <div id="solutionArea"></div>
        <div id="tileArea"></div>

        <div class="emoji-button-menu" onClick="() => {}">
          <button id="clearButton" class="button-84" role="button" onClick="reset()">Clear</button>
          <button class="emoji-button" role="button" onClick="shuffle()">ğŸ”„</button>
          <button id="deleteButton" class="button-84" role="button" onClick="goback()">Delete</button>
        </div>
        <div class="emoji-button-menu" onClick="() => {}">
          <button id="hintButton" class="button-84 show-next-button" role="button" onClick="onClickHint()">Show next letter</button>
        </div>
        <div id="hintsRemainingText">Hints remaining: <span id="hintsRemainingNumber">6</span></div>

        <div id="congratsModal" class="modal">
          <div class="modal-content">
            <span class="close" onClick="closeCongratsModal()">&times;</span>
            <div class="column-flex">
              <div class="goat">ğŸ</div>
              <div class="goat-text">You are the G.O.A.T. !!!</div>
            </div>
            <div id="shareableContent">
              <div class="share-content-row">
                <div>ğŸ</div>
                <div>ğŸ¦‰</div>
                <div>ğŸ¦’</div>
                <div>ğŸ¬</div>
                <div>ğŸ¦œ</div>
                <div>ğŸ™</div>
                <div>ğŸ</div>
              </div>
              <div class="share-content-row">
                <div>ğŸ™</div>
                <div>Anigrams</div>
                <div>ğŸ¦‰</div>
              </div>
              <div class="share-content-row">
                <div>ğŸ¦œ</div>
                <div id="shareNumber"></div>
                <div>ğŸ¦’</div>
              </div>
              <div class="share-content-row">
                <div>ğŸ¬</div>
                <div id="shareTime"></div>
                <div>ğŸ¬</div>
              </div>
              <div class="share-content-row">
                <div>ğŸ¦’</div>
                <div id="shareHints"></div>
                <div>ğŸ¦œ</div>
              </div>
              <div class="share-content-row">
                <div>ğŸ¦‰</div>
                <div id="shareStreak"></div>
                <div>ğŸ™</div>
              </div>
              <div class="share-content-row">
                <div>ğŸ</div>
                <div>ğŸ™</div>
                <div>ğŸ¦œ</div>
                <div>ğŸ¬</div>
                <div>ğŸ¦’</div>
                <div>ğŸ¦‰</div>
                <div>ğŸ</div>
              </div>
            </div>
            <div class="goat-modal-info-container">
              <div>
                <div>Next Anigram:</div>
                <div id="nextAnigram">XX</div>
              </div>
              <button id="shareButton" class="button-84" role="button" onClick="onClickShare()">Share</button>
            </div>

          </div>
        </div>

        <div id="rulesModal" class="modal">
          <div class="modal-content">
            <span class="close" onClick="closeModal('rulesModal')">&times;</span>
            <div class="rules-title">Rules</div>
            <div class="rules-info">
              <div>Unscramble a word to reveal the next letter.</div>
              <div>Each word must use every available letter exactly once.</div>
              <div>There may be multiple acceptable words at any given level, but you only need to enter one to advance.</div>
              <div>Feeling stuck? Use the "Show next letter" button for a hint... But use it wisely, as you only get 6 hints for the whole game!</div>
              <div>A new Anigrams puzzle will post every day at 9:30pm EST, 6:30pm PST</div>
            </div>
          </div>
        </div>
        <div id="aboutModal" class="modal">
          <div class="modal-content">
            <span class="close" onClick="closeModal('aboutModal')">&times;</span>
            <div class="about-content">
              <div>Created by Adam Wagner</div>
              <div>Developed by Rafael Musa</div>
              <div>Gameplay development by Jacob Goldberg</div>
              <br>
              <div>Special thanks to Anna Goldberg Wagner</div>
              <br>
              <div>Think we missed a word? Want to share some feedback? Have other questions? Hit us up at <a href="mailto:info@anigrams.us">info@anigrams.us</a></div>
            </div>
          </div>
        </div>
        <div id="countdownModal" class="modal">
          <div class="modal-content">
            <div>Nice work! Your timer is paused now.</div>
            <br />
            <div>Click the button when you're ready for the next puzzle.</div>
            <br />
            <button class="button-84" role="button" onClick="startNextLevel()">Start next puzzle</button>
          </div>
        </div>
        <div id="endModal" class="modal">
          <div class="modal-content">
            <label for="nameInput">What name would you like to use for our leaderboard?</label>
            <input id="nameInput" type="text">
            <div id="nameInputError">Name already in use</div>
            <button class="button-84" role="button" onClick="submitData()">Save data</button>
          </div>
        </div>
        <div id="startModal" class="modal">
          <div class="modal-content">
            <div class="start-modal-content">
              <div>Welcome to Anigrams ACPT</div>
              <div>Use the letters provided to unscramble words.</div>
              <div>You'll solve four puzzles in a row. You can use as many hints as you'd like, but they'll cost you 30 seconds each!</div>
              <div>Solve as fast as you can -- your times will be saved to a leaderboard.</div>
              <button class="button-84" role="button" onClick="startGame()">Start Game</button>
            </div>
          </div>
        </div>
        <div id="solutionsModal" class="modal">
          <div class="modal-content">
            <div id="yesterdayContent"></div>
          </div>
        </div>
      </article>
    </div>
  </main>
  <script src="https://www.gstatic.com/firebasejs/8.2.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-database.js"></script>
  <script type="module">
    // Import the functions you need from the SDKs you need
    // import {
    //   initializeApp
    // } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    // const firebaseConfig = {
    //   apiKey: "AIzaSyAj_yiz-BZy7Va0jF65QdtgJvrPjQjeyBI",
    //   authDomain: "ams-9571b.firebaseapp.com",
    //   projectId: "ams-9571b",
    //   storageBucket: "ams-9571b.appspot.com",
    //   messagingSenderId: "1089934717941",
    //   appId: "1:1089934717941:web:5213d886b4449a8f76e6bc"
    // };
    //
    // // Initialize Firebase
    // firebase.initializeApp(firebaseConfig);
  </script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAj_yiz-BZy7Va0jF65QdtgJvrPjQjeyBI",
      authDomain: "ams-9571b.firebaseapp.com",
      projectId: "ams-9571b",
      storageBucket: "ams-9571b.appspot.com",
      messagingSenderId: "1089934717941",
      appId: "1:1089934717941:web:5213d886b4449a8f76e6bc"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    var solutions = `SITE TIES TIERS RITES TIRES TRIES SISTER RESIST RELISTS SLITHERS SHIRTLESS
SING SIGN GINS PINGS SPYING SPRINGY SPRAYING SPARINGLY
READ DEAR DARE AIRED RAIDER MARRIED ADMIRER DREAMIER REMAINDER
SUED USED DUES DUNES NUDES UNDIES INSURED SUNDRIES SIDEBURNS BURNSIDES`

    var solutionsArray = solutions.split("\n");

    var badWordsList =
      "ASSHOLE ASSHOLES BITCH BITCHES SHIT SHITS SHITTING SHITTER SHITTY SHITTIER BULLSHIT FUCK FUCKS FUCKED FUCKING FUCKER FUCKERS CUNT CUNTS CUNTY CUNTIES TITS TITTIES TITTY COCK COCKS DICK DICKED DICKS PUSSY PUSSIES PUNANI PUNANIS TWAT TWATS SPIC SPICS NIGGER NIGGERS NIPS SPICK SPICKS BEANER BEANERS CHINK CHINKS CHINKER CHINKERS NIGGA NIGGAS NEGRO NEGROS CHOLO CHOLOS GOOK GOOKS WOGS GYPS GIPS KIKE KIKES KYKE KYKES DYKE DYKES FAGS MICK MICKS NIGLET NIGLETS PIKEY PIKEYS PIKER PIKERS RAGHEAD RAGHEADS REDSKIN REDSKINS SHYLOCK SHYLOCKS TARBABY TARBABIES WETBACK WETBACKS WOPS WENCH WENCHES FLOOZY FLOOZIE FLOOZIES BIMBO BIMBOS SHEMALE SHEMALES SLUT SLUTS TRANNY TRANNIE TRANNIES WHORE WHORES WHORED COCKSUCKER COCKSUCKERS NIGS"
    var badWordsSet = new Set(badWordsList.split(" ").map((word) => word.toLowerCase()));

    var puzzleIndex = 0;
    // var hintsUsed = [0, 0, 0, 0];
    var currHintsUsed = 0;
    var totalHintsUsed = 0;
    var times = [];
    var timer;
    var solution = processSolution(solutionsArray[puzzleIndex]);
    var currentWord = "";
    var currentRound = 0;
    var textToShare = 0;
    var emojiMapping = [
      'ğŸ¦‰',
      'ğŸ¦’',
      'ğŸ¬',
      'ğŸ¦œ',
      'ğŸ™',
      'ğŸ',
    ]
    var successMessages = [
      "Hoo-ray!",
      "Neck-cellent!",
      "TeEEEEErrific!",
      "Caw-esome!",
      "Gr-eight!",
      "Maaa-arvelous",
    ]
    var startTime = Math.floor(Date.now() / 1000); //Get the starting time (right now) in seconds

    function processSolution(solutionRow) {
      var processedSolution = [
        [],
        [],
        [],
        [],
        [],
        []
      ];
      var words = solutionRow.trim().split(" ");
      for (var i = 0; i < words.length; i++) {
        processedSolution[words[i].length - 4].push(words[i].toLowerCase());
      }
      return processedSolution;
    }

    function checkTime(i) {
      if (i < 10) {
        i = "0" + i
      }; // add zero in front of numbers < 10
      return i;
    }

    function setupLevel(puzzleIndex) {
      currentRound = 0;
      currentWord = "";
      if (totalHintsUsed < 6) {
        document.getElementById('hintButton').disabled = false
      }
      document.getElementById('solutionArea').innerHTML = '';
      document.getElementById('tileArea').innerHTML = '';
      solution = processSolution(solutionsArray[puzzleIndex]);
      solutionHeader = document.createElement('div');
      solutionHeader.innerHTML = `Puzzle ${puzzleIndex + 1}`
      document.getElementById('yesterdayContent').appendChild(solutionHeader)
      for (var i = 0; i < solution.length; i++) {
        var solutionRow = document.createElement('div');
        solutionRow.className = "solution-row";
        emojiDiv = document.createElement('div');
        emojiDiv.className = "emojiDiv";
        if (i === solution.length - 1) {
          // emojiDiv.classList.add("goat-tile");
          emojiDiv.className = "goat-tile-container"
          goat = document.createElement('div');
          goat.className = 'emojiDiv goat-tile';
          goat.innerText = emojiMapping[i];
          emojiDiv.appendChild(goat);
        } else {
          emojiDiv.innerText = emojiMapping[i];
        }
        // solutionRow.id = `solution-${i + 4}`
        solutionSlotContainer = document.createElement('div');
        solutionSlotContainer.className = "solution-slot-container";
        solutionSlotContainer.id = `solution-${i + 4}`
        solutionRow.appendChild(solutionSlotContainer);
        for (var j = 0; j < solution[i][0].length; j++) {
          var solutionSlot = document.createElement('div');
          solutionSlot.className = "solution-slot";
          solutionSlotContainer.appendChild(solutionSlot);
        }
        solutionRow.appendChild(emojiDiv)
        solutionSlotContainer.appendChild(document.createElement('div'))
        document.getElementById('solutionArea').appendChild(solutionRow);

        // add solution to modal shown at the end
        var yesterdayRow = document.createElement('div');
        yesterdayRow.className = "solution-row no-justify";
        yesterdayEmojiDiv = document.createElement('div');
        yesterdayEmojiDiv.className = "emojiDiv";
        yesterdayEmojiDiv.innerText = emojiMapping[i];
        for (var j = 0; j < solution[i][0].length; j++) {
          var yesterdaySlot = document.createElement('div');
          yesterdaySlot.className = "solution-slot yesterday-slot";
          yesterdaySlot.innerText = solution[i][0][j];
          yesterdayRow.appendChild(yesterdaySlot);
        }
        yesterdayRow.appendChild(yesterdayEmojiDiv)
        document.getElementById('yesterdayContent').appendChild(yesterdayRow);
      }
      document.getElementById('yesterdayContent').appendChild(document.createElement('br'));
      document.getElementById('yesterdayContent').appendChild(document.createElement('br'));


      for (var i = 0; i < solution[0][0].length; i++) {
        var newTile = document.createElement('div');
        newTile.className = "tile";
        newTile.addEventListener('click', clickTile);
        newTile.innerText = solution[0][0][i];
        document.getElementById('tileArea').appendChild(newTile);
      }
      // remove -1 for goat tile
      for (var i = 0; i < solution.length - 1; i++) {
        emojiTile = document.createElement('div');
        flipper = document.createElement('div');
        front = document.createElement('div');
        back = document.createElement('div');
        emojiTile.className = "tile flip-container emoji-tile";
        flipper.className = "flipper";
        front.className = "front";
        back.className = `back back-${i}`;
        front.innerText = emojiMapping[i];
        back.innerText = 'X';
        flipper.appendChild(front);
        flipper.appendChild(back);
        emojiTile.appendChild(flipper);
        document.getElementById('tileArea').appendChild(emojiTile)
      }

      // document.getElementById('hintsRemainingNumber').innerHTML = '6';

      if (document.querySelector(`#solution-${currentRound + 4}`)) {
        document.querySelector(`#solution-${currentRound + 4}`).firstChild.classList.add("active-solution-slot");
      }

      shuffle();
    }

    let prevTime = 0;

    // function startTimeCounter() {
    //   var now = Math.floor(Date.now() / 1000); // get the time now
    //   var diff = now - startTime + prevTime; // diff in seconds between now and start
    //   localStorage.setItem('currentTime', diff);
    //   var m = Math.floor(diff / 60); // get minutes value (quotient of diff)
    //   var s = Math.floor(diff % 60); // get seconds value (remainder of diff)
    //   m = checkTime(m); // add a leading zero if it's single digit
    //   s = checkTime(s); // add a leading zero if it's single digit
    //   document.getElementById("timer-acpt").innerHTML = m + ":" + s; // update the element where the timer will appear
    //
    //   var t = setTimeout(startTimeCounter, 500); // set a timeout to update the timer
    // }

    function startGame() {
      closeModal('startModal')
      timer = startTimer();
    }

    function startTimer() {
      var startTimeTimer, timer, obj,
        display = document.getElementById('timer-acpt');
      obj = {};
      obj.resume = function() {
        startTimeTimer = new Date().getTime();
        timer = setInterval(obj.step, 250); // adjust this number to affect granularity
        // lower numbers are more accurate, but more CPU-expensive
      };
      obj.pause = function() {
        ms = obj.step();
        times.push(ms);
        clearInterval(timer);
      };
      obj.step = function() {
        var now = new Date().getTime() - startTimeTimer,
          m = Math.floor(now / 60000),
          s = Math.floor(now / 1000) % 60;
        s = (s < 10 ? "0" : "") + s;
        display.innerHTML = m + ":" + s;
        return now;
      };
      obj.resume();
      return obj;
    }

    setupLevel(0);
    openModal('startModal');
    // shuffl e();
    // var timer = startTimer();

    function goback() {
      // var currHintsUsed = hintsUsed[puzzleIndex];
      // if (currentWord !== "") {
      if (currentWord.length > currHintsUsed) {
        var lastLetter = currentWord[currentWord.length - 1];
        currentWord = currentWord.slice(0, -1)
        document.querySelector(`#solution-${currentRound + 4} :nth-child(${currentWord.length + 1})`).innerText = "";
        document.querySelector(`#solution-${currentRound + 4} :nth-child(${currentWord.length + 2})`).classList.remove("active-solution-slot")
        document.querySelector(`#solution-${currentRound + 4} :nth-child(${currentWord.length + 1})`).classList.add("active-solution-slot")
        var usedTiles = document.querySelectorAll('.used-tile');
        var tile = [...usedTiles].filter((usedTile) => usedTile.innerText === lastLetter)[0];
        tile.classList.remove('used-tile');
      }
    }

    function onKeyDown(e) {
      if (!e.repeat) {
        if (e.key === 'Backspace') {
          goback();
          return;
        }
        var index = [...document.getElementById('tileArea').children].map((child) => child.classList.contains('used-tile') ? '?' : child.innerText.toLowerCase()).indexOf(e.key);
        if (index !== -1) {
          document.querySelector(`#tileArea :nth-child(${index + 1})`).click();
        }
      }
    }

    document.addEventListener('keydown', onKeyDown);

    function onClickShare() {
      if (navigator.share) {
        navigator.share({
          text: textToShare,
        });
      } else {
        navigator.clipboard.writeText(textToShare)
        document.getElementById('shareButton').innerText = "Copied to clipboard";
        setTimeout(() => document.getElementById('shareButton').innerText = "Share", 1000);
      }
    }

    function clickTile(ev) {
      currentWord += ev.target.innerText;

      document.querySelector(`#solution-${currentRound + 4} :nth-child(${currentWord.length})`).innerText = ev.target.innerText;
      document.querySelector(`#solution-${currentRound + 4} :nth-child(${currentWord.length})`).classList.remove("active-solution-slot")
      if (currentWord.length !== currentRound + 4) {
        document.querySelector(`#solution-${currentRound + 4} :nth-child(${currentWord.length + 1})`).classList.add("active-solution-slot");
      }
      ev.target.classList.add("used-tile");
      // correct word
      if (solution.flat().includes(currentWord.toLowerCase()) && currentWord.length === currentRound + 4) {
        // new level means we're back to first letter for hints
        // localStorage.setItem('currLevelHints', 0);
        currHintsUsed = 0;
        document.getElementById('hintButton').disabled = true;

        // change active answer cell
        // localStorage.setItem('currentDay', puzzleIndex + 1);
        // localStorage.setItem('currentSolution', (localStorage.getItem('currentSolution') || "") + currentWord + "|")

        // deal with success message
        var feedbackContainer = document.createElement('div');
        feedbackContainer.className = "feedbackContainer";
        var feedbackMessage = document.createElement('div');
        feedbackMessage.innerText = successMessages[currentRound];
        feedbackMessage.className = "incorrectFeedback";
        feedbackMessage.classList.add("showIncorrectFeedback");
        feedbackContainer.appendChild(feedbackMessage);
        document.querySelector(`#solution-${currentRound + 4}`).parentElement.lastChild.appendChild(feedbackContainer);
        setTimeout(() => feedbackMessage.classList.remove("showIncorrectFeedback"), 500);
        setTimeout(() => {
          reset(true);
          currentRound++;
          if (currentRound === solution.length) {
            // solved yesterday
            // if (Number(localStorage.getItem('lastSolved')) === puzzleIndex) {
            //   localStorage.setItem('streak', (Number(localStorage.getItem('streak')) || 0) + 1)
            // } else {
            //   localStorage.setItem('streak', 1)
            // }
            // localStorage.setItem('lastSolved', puzzleIndex + 1)
            // var now = Math.floor(Date.now() / 1000);
            // var diff = now - startTime + prevTime;
            // var totalMinutes = Math.floor(diff / 60);
            // var h = Math.floor(totalMinutes / 60);
            // var m = Math.floor(totalMinutes % 60);
            // var s = Math.floor(diff % 60);
            // h = checkTime(h)
            // m = checkTime(m);
            // s = checkTime(s);
            // localStorage.setItem('shareTime', `${h}:${m}:${s}`)
            // timeShareText = localStorage.getItem('shareHints') > 0 ? localStorage.getItem('shareTime') : `â­${localStorage.getItem('shareTime')}â­`
            // textToShare =
            //   `ğŸ¦‰ğŸ¦’ğŸ¬ğŸ¦œğŸ™ğŸ\r\nAnigrams ${puzzleIndex + 1}\r\n${timeShareText}\r\nHints used: ${localStorage.getItem('shareHints') || 0}\r\nStreak: ${localStorage.getItem('streak').toString()}\r\nğŸ¦‰ğŸ¦’ğŸ¬ğŸ¦œğŸ™ğŸ\r\nanigrams.us`;
            // document.getElementById('shareNumber').innerText = (puzzleIndex + 1).toString();
            // document.getElementById('shareTime').innerText = `${h}:${m}:${s}`
            // document.getElementById('shareHints').innerText = `Hints: ${localStorage.getItem('shareHints') || 0}`
            // document.getElementById('shareStreak').innerText = `Streak: ${localStorage.getItem('streak').toString()}`
            // document.querySelector('.goat-tile').classList.add('goat-tile-grow');
            // setTimeout(() => document.getElementById('congratsModal').style.display = "block", 1200);
            timer.pause();
            if (puzzleIndex === 3) {
              document.removeEventListener('keydown', onKeyDown)
              openModal('endModal');
            } else {
              openModal('countdownModal');
            }
            // startCountdown();
            // setTimeout(() => {
            //   closeModal('countdownModal')
            //   document.getElementById('countdown').innerHTML = '6';
            //   puzzleIndex += 1;
            //   setupLevel(puzzleIndex);
            // }, 5000)

            return;
          }
          document.querySelector(`#solution-${currentRound + 4}`).firstChild.classList.add("active-solution-slot");
          var tileToFlip = document.querySelector('.emoji-tile')
          tileToFlip.firstChild.children[1].innerText = findNewLetter(currentRound);
          setTimeout(() => {
            tileToFlip.firstChild.classList.add("flip");
          }, 500);
          setTimeout(() => {
            var newTile = document.createElement('div');
            newTile.className = "tile";
            newTile.addEventListener('click', clickTile);
            newTile.innerText = findNewLetter(currentRound);
            document.getElementById('tileArea').insertBefore(newTile, tileToFlip);
            tileToFlip.remove();
            // if (localStorage.getItem('hintsRemaining') !== '0') {
            document.getElementById('hintButton').disabled = false;
            // }
          }, 900);
        }, 0)
      }
      // incorrect word
      else if (currentWord.length === currentRound + 4) {
        var feedbackContainer = document.createElement('div');
        feedbackContainer.className = "feedbackContainer";
        var feedbackMessage = document.createElement('div');
        feedbackMessage.innerText = "Invalid word";
        feedbackMessage.className = "incorrectFeedback";
        feedbackMessage.classList.add("showIncorrectFeedback");
        feedbackContainer.appendChild(feedbackMessage);
        document.querySelector(`#solution-${currentRound + 4}`).parentElement.lastChild.appendChild(feedbackContainer);
        setTimeout(() => feedbackMessage.classList.remove("showIncorrectFeedback"), 500);
        setTimeout(() => {
          reset();
          document.querySelector(`#solution-${currentRound + 4}`).parentElement.lastChild.lastChild.remove();
        }, 700);
      }
    }

    function startNextLevel() {
      puzzleIndex += 1;
      setupLevel(puzzleIndex);
      closeModal('countdownModal')
      timer.resume();
    }

    function submitData() {
      document.getElementById('nameInputError').style.display = "none";
      var userName = document.getElementById("nameInput").value;

      firebase.database().ref().child(userName).get().then((snapshot) => {
        if (snapshot.exists()) {
          console.log(snapshot.val());
          document.getElementById('nameInputError').style.display = "block";
        } else {
          firebase.database().ref(userName).set({
            name: userName,
            times: times,
            hintsUsed: totalHintsUsed,
          });
          closeModal('endModal')
          openModal('solutionsModal')
        }
      }).catch((error) => {
        console.error(error);
      });
    }

    // function startCountdown() {
    //   currVal = document.getElementById('countdown').innerHTML;
    //   document.getElementById('countdown').innerHTML = currVal - 1
    //
    //   if (currVal > 0) {
    //     setTimeout(startCountdown, 1000);
    //   }
    // }

    function onClickHint() {
      document.getElementById('hintButton').innerHTML = "Are you sure?";
      document.getElementById('hintButton').onclick = showNextLetter;
      setTimeout(() => {
        document.getElementById('hintButton').innerHTML = "Show next letter";
        document.getElementById('hintButton').onclick = onClickHint;
      }, 3000)
    }

    function showNextLetter() {
      document.getElementById('hintButton').innerHTML = "Show next letter";
      document.getElementById('hintButton').onclick = onClickHint;
      var prevHintsRemaining = document.getElementById("hintsRemainingNumber").innerHTML;
      // should never happen because the button should be disabled, but adding check just in case
      if (prevHintsRemaining === "0") {
        return;
      }
      reset();
      document.getElementById("hintsRemainingNumber").innerHTML = prevHintsRemaining - 1;
      // localStorage.setItem('currLevelHints', Number(localStorage.getItem('currLevelHints') || 0) + 1);
      // localStorage.setItem('shareHints', Number(localStorage.getItem('shareHints') || 0) + 1);
      // localStorage.setItem('hintsRemaining', prevHintsRemaining - 1);
      // localStorage.setItem('currentDay', puzzleIndex + 1);
      // var lettersToShow = Number(localStorage.getItem('currLevelHints'));
      currHintsUsed += 1
      totalHintsUsed += 1
      // var lettersToShow = hintsUsed[puzzleIndex]
      if (currentWord.toLowerCase() === solution[currentRound][0].substr(0, currHintsUsed).toLowerCase()) {
        return;
      }
      // reset()
      // for (var i = 0; i < lettersToShow; i++) {
      var index = [...document.getElementById('tileArea').children].map((child) => child.classList.contains("used-tile") ? '' : child.innerText.toLowerCase()).indexOf(solution[currentRound][0][currHintsUsed - 1]);
      document.querySelector(`#tileArea :nth-child(${index + 1})`).click();
      // }
      if (prevHintsRemaining === "1") {
        document.getElementById('hintButton').disabled = true;
      }
    }

    function findNewLetter(round) {
      oldLetters = solution[round - 1][0].split('').sort().join('');
      newLetters = solution[round][0].split('').sort().join('');
      for (var i = 0; i < oldLetters.length; i++) {
        if (oldLetters[i] !== newLetters[i]) {
          return newLetters[i];
        }
      }
      return newLetters[newLetters.length - 1];
    }

    function reset(preserveWord = false) {
      var hintWord = currentWord.substring(0, currHintsUsed);
      var hintLetters = hintWord.split('');
      [...document.querySelectorAll('.used-tile')].forEach((usedTile) => {
        indexInHints = hintLetters.indexOf(usedTile.innerText.toUpperCase());
        if (indexInHints === -1) {
          usedTile.classList.remove('used-tile');
        } else {
          hintLetters.splice(indexInHints, 1);
        }
      });
      document.querySelector(`#solution-${currentRound + 4} :nth-child(${currentWord.length + 1})`).classList.remove("active-solution-slot");
      currentWord = preserveWord ? "" : hintWord;
      if (!preserveWord) {
        solutionSlots = [...document.querySelectorAll(`#solution-${currentRound + 4} .solution-slot`)];
        solutionSlots.splice(0, currHintsUsed);
        solutionSlots.map((child) => child.innerText = "");
        document.querySelector(`#solution-${currentRound + 4} :nth-child(${currHintsUsed + 1})`).classList.add("active-solution-slot");
      }
    }

    function shuffle() {
      var tiles = document.getElementById('tileArea');
      while (true) {
        for (var i = currentRound + 4; i >= 0; i--) {
          tiles.insertBefore(tiles.children[Math.random() * i | 0], tiles.children[currentRound + 4]);
        }
        const randomArrangement = [...tiles.children].slice(0, currentRound + 4).map((child) => child.innerText).join('').toLowerCase();
        if (!solution.flat().includes(randomArrangement) && !badWordsSet.has(randomArrangement)) {
          break;
        }
      }
    }

    function closeCongratsModal() {
      document.getElementById("congratsModal").style.display = "none";
      document.querySelector('.goat-tile').remove();
    }

    function closeModal(modalId) {
      document.getElementById(modalId).style.display = "none";
    }

    function openModal(modalId) {
      document.getElementById(modalId).style.display = "block";
    }
  </script>
</body>

</html>