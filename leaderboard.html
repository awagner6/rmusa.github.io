<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <title>Anigrams</title>
  <meta name="generator" content="Jekyll v3.9.2" />
  <meta property="og:title" content="ü¶âü¶íüê¨ Anigrams ü¶úüêôüêê" />
  <meta property="og:locale" content="en_US" />
  <meta name="description" content="A daily word game" />
  <meta property="og:description" content="A daily word game" />
  <link rel="canonical" href="http://anigrams.us" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üêê</text></svg>">
  <meta property="og:url" content="http://anigrams.us" />
  <meta property="og:site_name" content="ü¶âü¶íüê¨ Anigrams ü¶úüêôüêê" />
  <meta property="og:type" content="website" />
  <meta name="twitter:card" content="summary" />
  <meta property="twitter:title" content="ü¶âü¶íüê¨ Anigrams ü¶úüêôüêê" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,300">
  <!-- <link rel="stylesheet" href="main.css"> -->
  <link rel="stylesheet" href="table.css">
</head>

<body ontouchstart="">
  <main class="page-content" aria-label="Content">
    <div class="scores">
      <table>
        <thead>
          <tr>
            <th>Index</th>
            <th>Name</th>
            <th>Puzzle 1</th>
            <th>Puzzle 2</th>
            <th>Puzzle 3</th>
            <th>Puzzle 4</th>
            <th>Puzzle 5</th>
            <th>Total Time</th>
            <th>Hints Used</th>
            <th>DNF</th>
            <th>Final Score</th>
          </tr>
        </thead>
        <tbody id="leaderboardBody">
        </tbody>
      </table>
  </main>

  <script src="https://www.gstatic.com/firebasejs/8.2.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-database.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAj_yiz-BZy7Va0jF65QdtgJvrPjQjeyBI",
      authDomain: "ams-9571b.firebaseapp.com",
      projectId: "ams-9571b",
      storageBucket: "ams-9571b.appspot.com",
      messagingSenderId: "1089934717941",
      appId: "1:1089934717941:web:5213d886b4449a8f76e6bc"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    var scores = firebase.database().ref();
    scores.on('value', (snapshot) => {
      const data = snapshot.val();
      // console.log(data);
      updateLeaderboard(data);
    });

    function updateLeaderboard(data) {
      var table = document.getElementById('leaderboardBody');
      table.innerHTML = '';
      var scores = Object.values(data).sort((a, b) => a.times.reduce((x, y) => x + y) - b.times.reduce((x, y) => x + y));
      scores.forEach(({
        name,
        hintsUsed,
        dnf,
        times
      }, index) => {
        var tr = document.createElement('tr')
        tr.appendChild(createTableData(index + 1))
        tr.appendChild(createTableData(name))
        times.forEach((time) => {
          tr.appendChild(createTableData(convertMs(time)))
        })
        tr.appendChild(createTableData(convertMs(times.reduce((x, y) => x + y))))
        tr.appendChild(createTableData(hintsUsed))
        tr.appendChild(createTableData(dnf))
        table.appendChild(tr);
      });
    }

    function createTableData(value) {
      var td = document.createElement('td');
      td.innerHTML = value;
      return td;
    }

    function convertMs(t) {
      t = t + 1000;
      m = Math.floor(t / 60000);
      s = Math.floor(t / 1000) % 60;
      s = (s < 10 ? "0" : "") + s;
      return m + ":" + s;
    }
  </script>
</body>

</html>